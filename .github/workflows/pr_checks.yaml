name: HOPR Pre-merge Checks

env:
  HOPR_GITHUB_REF: ${{ github.ref }}
  HOPR_GITHUB_BASE_REF: ${{ github.base_ref }}

on:
  pull_request:
    types: [ synchronize ]

jobs:
  deployment_check:
    name: Upstream deployment status check
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Check deployment status of the upstream branch
        if: ${{ (github.base_ref == 'master' || startsWith(github.base_ref, 'debug-deploy/') || startsWith(github.base_ref, 'release/')) && !env.ACT }}
        run:
          ./scripts/deployment-status.sh check ${{ github.ref_name }}