[package]
name = "hoprd"
version = "2.2.0"
authors = ["HOPR Association <tech@hoprnet.org>"]
edition = "2021"
description = "HOPR node executable."
homepage = "https://hoprnet.org/"
repository = "https://github.com/hoprnet/hoprnet"
license = "GPL-3.0-only"
build = "build.rs"

[features]
default = ["runtime-async-std", "prometheus"]   # must be async-std due to tide framework
prometheus = [
    "dep:hopr-metrics",
    "dep:lazy_static",
    "hopr-lib/prometheus",
    "hoprd-api/prometheus"
]
runtime-async-std = [
    "dep:async-std",
    "hopr-lib/runtime-async-std",
    "opentelemetry_sdk?/rt-async-std"
]
runtime-tokio = [
    "dep:tokio",
    "hopr-lib/runtime-tokio",
    "opentelemetry_sdk?/rt-tokio"
]
telemetry = ["dep:opentelemetry", "dep:opentelemetry-otlp", "dep:opentelemetry_sdk", "dep:tracing-opentelemetry"]

[dependencies]
async-broadcast = { workspace = true }
async-lock = { workspace = true }
async-signal = { workspace = true }
async-std = { workspace = true, features = ["attributes", "tokio1"], optional = true }
clap = { workspace = true }
chrono = { workspace = true }
futures = { workspace = true }
hex = { workspace = true }
home = "0.5"
humantime = "2.1.0"
lazy_static = { workspace = true, optional = true }
proc-macro-regex = "~1.1.0"
prost = "0.12.3"
serde = { workspace = true }
serde_yaml = "0.9"
serde_json = "1.0"
signal-hook = { workspace = true }
strum = { workspace = true }
thiserror = { workspace = true }
tokio = { workspace = true, optional = true }
tracing = { workspace = true }
tracing-subscriber = { workspace = true }
validator = { workspace = true }

opentelemetry = { version = "0.22", optional = true }
opentelemetry-otlp = { version = "0.15", default-features = false, features = ["trace", "reqwest-client", "tls-roots", "http-proto", "grpc-tonic"], optional = true }
opentelemetry_sdk = { version = "0.22", optional = true }
tracing-opentelemetry = { version = "0.23", optional = true }

hopr-lib = { workspace = true }
hoprd-api = { workspace = true }
hoprd-inbox = { workspace = true }
hoprd-keypair = { workspace = true }
hopr-platform = { workspace = true }
hopr-metrics = { workspace = true, optional = true }

[dev-dependencies]
tempfile = { workspace = true }

[build-dependencies]
vergen-gitcl = { version = "1.0.0-beta.2", features = ["build"] }
anyhow = "1"


