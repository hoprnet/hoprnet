\subsection{Threat Model}
\label{sec:intro:threatmodel}

Although we assume that nodes in the HOPR network can communicate reliably, the network must still be protected from malicious actors and node failures. We assume a threat model with Byzantine nodes with the ability to either observe all network traffic and launch network attacks or to inject, drop, or delay packets as follows:

\subsubsection{Global passive adversaries (GPAs)} A global passive adversary (GPA) is an attacker who can observe the entirety of network traffic passing between users. A GPA is considered passive because their attacks are based on observation alone. A theoretical GPA is arbitrarily powerful, and their full abilities are unlikely to be manifest in any real-world attacker. Nonetheless, building a network which is GPA-resistant introduces extra security through redundancy and future-proofing.

Thanks to the properties of Sphinx (see Section \ref{sec:sphinx}) and proof of relay (see Section \ref{sec:incentives:proofofrelay}), HOPR is able to defend against GPAs. Nonetheless, it is worth mentioning some additional attacks that a decentralized mixnet like HOPR is particularly vulnerable to by virtue of its decentralized and anonymous nature.

\subsubsection{Sybil attacks}
In a Sybil attack, an attacker forges multiple identities in the network, thereby introducing network redundancy and reducing system security. The attacker can potentially de-anonymize packet traffic and thus link the sender and recipient's identities. HOPR mitigates Sybil attacks via the trust assumption of the Sphinx packet format: only a single honest relayer is needed to ensure integrity of the entire transmission chain, and since the traffic is source routed, users can choose routes themselves to ensure this minimal requirement of one honest relayer is met. Since path selection is dependant on a financial stake, launching a Sybil attack would be prohibitively expensive.

\subsubsection{Eclipse attacks}
Many decentralized networks suffer from a general unavailability of a general understanding of their topology, hence nodes cannot determine whether their respective local views are complete or accurate. As an attacker, it might be attractive to flood a victim with inaccurate information about collaborating nodes while withholding information about honest nodes.

HOPR mitigates this issue by using a different medium to announce entry nodes to the network. This is done using a smart contract on a blockchain and known within HOPR as DEADR (Decentralized Entry Advertisement and Distributed Relaying). DEADR nodes serve two functions: (1) providing access to the distributed hash table (DHT) that is used within the libp2p environment that HOPR leverages and (2) facilitating network address translation (NAT) or relaying traffic that cannot be sent directly between adjacent nodes who reside in separate internet sub-networks (e.g., computers without a public internet-facing internet protocol (IP) address behind typical home routers). A HOPR node only requires access to one honest DEADR node and it is significantly cheaper in computational terms to check whether a DEADR node is honest than to conduct an eclipse attack, which requires on-chain transactions. A successful eclipse attack therefore requires controlling all announced DEADR nodes or forging a public blockchain, both of which we assume are impossible and beyond the scope of this work.

Thus we are satisfied that HOPR more than adequately protects users against attack. However, security cannot come at the expense of usability. To be appealing to users and node runners alike, it is important for HOPR to find a satisfactory compromise to what is known as the ``anonymity trilemma" \cite{AnonymityTrilemma}, which states that a privacy network can provide at most two of the following properties: low latency communication, low bandwidth overhead, and strong anonymity.

The rest of this paper will outline the current state of the art among anonymous communication protocols and layer-2 scalability protocols, describe how the HOPR network is built, and explain how HOPR provides a satisfactory resolution to the anonymity trilemma.
