<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Auto Funding Strategy"><title>hopr_strategy::auto_funding - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-b7b9f40b.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="hopr_strategy" data-themes="" data-resource-suffix="" data-rustdoc-version="1.95.0-nightly (7057231bd 2026-02-11)" data-channel="nightly" data-search-js="search-fb33671b.js" data-stringdex-js="stringdex-b897f86f.js" data-settings-js="settings-170eb4bf.js" ><script src="../../static.files/storage-f9617a14.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-12f88f4f.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-f7c3ffd8.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><a class="skip-main-content" href="#main-content">Skip to main content</a><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Module auto_funding</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../hopr_strategy/index.html">hopr_<wbr>strategy</a><span class="version">0.17.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module auto_<wbr>funding</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#auto-funding-strategy" title="Auto Funding Strategy">Auto Funding Strategy</a><ul><li><a href="#in-flight-tracking" title="In-flight tracking">In-flight tracking</a></li><li><a href="#metrics" title="Metrics">Metrics</a></li></ul></li></ul><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate hopr_<wbr>strategy</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content" tabindex="-1"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">hopr_strategy</a></div><h1>Module <span>auto_<wbr>funding</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/hopr_strategy/auto_funding.rs.html#1-654">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h3 id="auto-funding-strategy"><a class="doc-anchor" href="#auto-funding-strategy">§</a>Auto Funding Strategy</h3>
<p>This strategy listens for channel state change events to check whether a channel has dropped below
<code>min_stake_threshold</code> HOPR. If this happens, the strategy issues a <strong>fund channel</strong> transaction to re-stake the
channel with <code>funding_amount</code> HOPR.</p>
<p>Additionally, the strategy periodically scans all outgoing open channels on each tick and funds
any that have fallen below the threshold. This catches channels opened with low balance and
channels that were underfunded when the node started.</p>
<h4 id="in-flight-tracking"><a class="doc-anchor" href="#in-flight-tracking">§</a>In-flight tracking</h4>
<p>To prevent duplicate funding when multiple balance-decrease events arrive in quick succession,
the strategy maintains a set of channel IDs currently being funded.
A channel is added to the set when a funding tx is successfully enqueued, and removed when:</p>
<ul>
<li>The spawned confirmation task observes a transaction failure,</li>
<li>A balance increase event is observed for that channel (indicating the funding confirmed), or</li>
<li>An <code>on_tick</code> scan finds the channel’s balance has risen above the threshold.</li>
</ul>
<h4 id="metrics"><a class="doc-anchor" href="#metrics">§</a>Metrics</h4>
<ul>
<li><code>hopr_strategy_auto_funding_funding_count</code> — incremented when a funding tx is successfully enqueued</li>
<li><code>hopr_strategy_auto_funding_failure_count</code> — incremented when a funding tx fails to enqueue or confirm</li>
</ul>
<p>For details on default parameters see <a href="struct.AutoFundingStrategyConfig.html" title="struct hopr_strategy::auto_funding::AutoFundingStrategyConfig">AutoFundingStrategyConfig</a>.</p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.AutoFundingStrategy.html" title="struct hopr_strategy::auto_funding::AutoFundingStrategy">Auto<wbr>Funding<wbr>Strategy</a></dt><dd>The <code>AutoFundingStrategy</code> automatically funds a channel that
dropped its staked balance below the configured threshold.</dd><dt><a class="struct" href="struct.AutoFundingStrategyConfig.html" title="struct hopr_strategy::auto_funding::AutoFundingStrategyConfig">Auto<wbr>Funding<wbr>Strategy<wbr>Config</a></dt><dd>Configuration for <code>AutoFundingStrategy</code></dd></dl></section></div></main></body></html>